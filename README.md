# VanillaRAGPlus ..é€æ­¥å®Œå–„ä¸­ ğŸ‘¨ğŸ»â€ğŸ’»

è¿™æ˜¯ä¸€ä¸ªåŸºäº FastAPI å’Œ Vue3 çš„æ–‡æ¡£é—®ç­”ç³»ç»Ÿï¼Œæ”¯æŒæ–‡æ¡£ä¸Šä¼ ã€ç®¡ç†å’Œæ™ºèƒ½é—®ç­”åŠŸèƒ½ï¼Œä½¿ç”¨ Milvus å‘é‡æ•°æ®åº“è¿›è¡Œæ–‡æ¡£å­˜å‚¨å’Œæ£€ç´¢ã€‚

## é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ backend/                # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/                # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ documents.py    # æ–‡æ¡£ç®¡ç†æ¥å£
â”‚   â”‚   â”œâ”€â”€ rag.py          # RAGæ£€ç´¢æ¥å£
â”‚   â”‚   â””â”€â”€ conversations.py # å¯¹è¯å†å²æ¥å£
â”‚   â”œâ”€â”€ service/            # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ document_service.py  # æ–‡æ¡£å¤„ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ milvus_service.py    # Milvuså‘é‡åº“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ rag_service.py       # RAGæ£€ç´¢æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ llm_service.py       # å¤§è¯­è¨€æ¨¡å‹æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ conversation_service.py # å¯¹è¯å†å²æœåŠ¡
â”‚   â”‚   â””â”€â”€ config.py            # ç³»ç»Ÿé…ç½®
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ db/                 # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ model_weight/       # æœ¬åœ°æ¨¡å‹æƒé‡
â”‚   â”œâ”€â”€ uploads/            # ä¸Šä¼ æ–‡ä»¶å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ milvus/             # Milvusç›¸å…³é…ç½®
â”‚   â”œâ”€â”€ main.py             # ä¸»åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ run.py              # å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ requirements.txt    # ä¾èµ–é¡¹
â”œâ”€â”€ frontend/               # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ src/                # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ components/     # ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Chat.vue           # èŠå¤©ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ DocumentManagement.vue # æ–‡æ¡£ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ views/          # è§†å›¾
â”‚   â”‚   â”œâ”€â”€ assets/         # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ App.vue         # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.js         # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html          # HTMLå…¥å£
â”‚   â”œâ”€â”€ package.json        # ä¾èµ–é¡¹
â”‚   â””â”€â”€ vite.config.js      # Viteé…ç½®
â”œâ”€â”€ docker/                 # Dockeré…ç½®
â”‚   â”œâ”€â”€ docker-compose.yml  # Dockerç»„åˆé…ç½®
â”‚   â””â”€â”€ init-scripts/       # åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ start.sh                # é¡¹ç›®å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## æŠ€æœ¯æ ˆ

### åç«¯

- FastAPI: é«˜æ€§èƒ½ Web æ¡†æ¶ï¼Œç”¨äºæ„å»º API æ¥å£
- LangChain: å¤§è¯­è¨€æ¨¡å‹åº”ç”¨æ¡†æ¶ï¼Œç”¨äºæ„å»º RAG åº”ç”¨
- Milvus: å¼€æºå‘é‡æ•°æ®åº“ï¼Œç”¨äºé«˜æ•ˆå‘é‡æ£€ç´¢
- PyPDF/docx2txt: æ–‡æ¡£è§£æåº“ï¼Œæ”¯æŒå¤šç§æ ¼å¼çš„æ–‡æ¡£è§£æ
- PostgreSQL: å…³ç³»å‹æ•°æ®åº“ï¼Œç”¨äºå­˜å‚¨å¯¹è¯å†å²å’Œæ–‡æ¡£å…ƒæ•°æ®
- BGE æ¨¡å‹: ç”¨äºæ–‡æœ¬å‘é‡åŒ–å’Œç›¸å…³æ€§é‡æ’åº

### å‰ç«¯

- Vue 3: æ¸è¿›å¼ JavaScript æ¡†æ¶
- Element Plus: UI ç»„ä»¶åº“
- Axios: HTTP å®¢æˆ·ç«¯

## åŠŸèƒ½ç‰¹æ€§

- æ–‡æ¡£ä¸Šä¼ ä¸ç®¡ç†ï¼šæ”¯æŒ PDFã€TXTã€DOCX æ ¼å¼æ–‡æ¡£çš„ä¸Šä¼ ã€æŸ¥çœ‹å’Œåˆ é™¤
- æ–‡æ¡£å‘é‡åŒ–ï¼šè‡ªåŠ¨è§£ææ–‡æ¡£å†…å®¹å¹¶å­˜å‚¨åˆ° Milvus å‘é‡æ•°æ®åº“
- æ™ºèƒ½é—®ç­”ï¼šåŸºäº RAG(æ£€ç´¢å¢å¼ºç”Ÿæˆ)æŠ€æœ¯çš„æ–‡æ¡£æ™ºèƒ½é—®ç­”
- æ··åˆæ£€ç´¢æŠ€æœ¯ï¼šç»“åˆè¯­ä¹‰æ£€ç´¢å’Œå…³é”®è¯æ£€ç´¢çš„æ··åˆæ£€ç´¢ç­–ç•¥ï¼Œæé«˜æ£€ç´¢ç²¾åº¦å’Œå¬å›ç‡
- å¯¹è¯å†å²ï¼šä¿å­˜ä¸æ–‡æ¡£çš„äº¤äº’å¯¹è¯å†å²
- é—®é¢˜ä¼˜åŒ–ï¼šæ”¯æŒé—®é¢˜é‡å†™æ‰©å±•å’Œç›¸å…³æ€§åˆ¤æ–­ï¼Œæé«˜æ£€ç´¢è´¨é‡
- æ£€ç´¢ç»“æœé‡æ’ï¼šä½¿ç”¨ BGE-Reranker ä¼˜åŒ–æ£€ç´¢ç»“æœç›¸å…³æ€§

## å®‰è£…ä¸è¿è¡Œ

### æ•°æ®åº“

Step1ï¼šä½¿ç”¨ Docker Compose å¯åŠ¨ PostgreSQL æ•°æ®åº“ï¼š

```bash
cd docker
docker-compose up -d
```

è¿™å°†å¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼š

- PostgreSQL: å­˜å‚¨å¯¹è¯å†å²å’Œæ–‡æ¡£å…ƒæ•°æ®
- pgAdmin: æ•°æ®åº“ç®¡ç†å·¥å…·(å¯é€‰)ï¼Œè®¿é—®åœ°å€ä¸º http://localhost:5050

Step2ï¼šå®‰è£…åŸºç¡€ä¸­é—´ä»¶

```shell
// å®‰è£…Redis
$ docker pull redis:6.2.12
$ docker run --name redis -p 6379:6379 -d redis:6.2.12 --requirepass "52497Vr62K94qeksg82679o22kr774ee" --appendonly yes

// å®‰è£…Milvus
$ mkdir milvus && cd milvus
$ curl -sfL https://raw.githubusercontent.com/milvus-io/milvus/master/scripts/standalone_embed.sh -o standalone_embed.sh
$ ./standalone_embed.sh start

// å»ºè®®æ‰“å¼€Milvusçš„è´¦å·éªŒè¯
$ docker exec -it milvus-standalone /bin/bash
$ apt-get update && apt-get install vim -y
$ vim /milvus/configs/milvus.yaml                    //  å°†authorizationEnabledå‚æ•°æ”¹ä¸ºtrue
$ exit
$ docker restart milvus-standalone
$ cd script
$ python3 milvus_password.py
```

Step3ï¼šä¸‹è½½æ‰€éœ€æ¨¡å‹

```shell
$ mkdir model_weight
$ cd script
$ python3 download_models.py
```

### ä¸€é”®å¯åŠ¨

ä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•çš„`start.sh`è„šæœ¬ä¸€é”®å¯åŠ¨æ•´ä¸ªåº”ç”¨ï¼š

```bash
chmod +x start.sh  # æ·»åŠ æ‰§è¡Œæƒé™
./start.sh
```

ç³»ç»Ÿå¯åŠ¨åï¼š

- åç«¯ API: http://localhost:8080
- å‰ç«¯ç•Œé¢: http://localhost:3000

## ä½¿ç”¨è¯´æ˜

1. åœ¨"æ–‡æ¡£ç®¡ç†"é¡µé¢ï¼Œæ‚¨å¯ä»¥ä¸Šä¼ ã€æŸ¥çœ‹å’Œåˆ é™¤æ–‡æ¡£
2. ä¸Šä¼ æ–‡æ¡£åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§£ææ–‡æ¡£å†…å®¹å¹¶å­˜å‚¨åˆ°å‘é‡æ•°æ®åº“
3. åœ¨"å¼€å¯å¯¹è¯"é¡µé¢ï¼Œæ‚¨å¯ä»¥ä¸ä¸Šä¼ çš„æ–‡æ¡£è¿›è¡Œé—®ç­”äº¤äº’
4. ç³»ç»Ÿä¼šä¿å­˜å¯¹è¯å†å²ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å†å²å¯¹è¯å†…å®¹

## éƒ¨ç½²æ–¹å¼

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Docker éƒ¨ç½²

#### å‰ææ¡ä»¶

- å®‰è£… [Docker](https://docs.docker.com/get-docker/)
- å®‰è£… [Docker Compose](https://docs.docker.com/compose/install/)

#### éƒ¨ç½²æ­¥éª¤

1. å…‹éš†ä»£ç ä»“åº“

```bash
git clone <ä»“åº“åœ°å€>
cd VanillaRAGPlus
```

2. è¿è¡Œéƒ¨ç½²è„šæœ¬

```bash
./start-docker.sh
```

æˆ–è€…æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# åˆ›å»ºå¿…è¦çš„ç›®å½•
mkdir -p docker/nginx
mkdir -p docker/init-scripts
mkdir -p backend/uploads
mkdir -p backend/logs

# å¯åŠ¨æœåŠ¡
cd docker
docker-compose up -d
```

3. è®¿é—®ç³»ç»Ÿ

- å‰ç«¯ç•Œé¢ï¼šhttp://localhost:3000
- åç«¯ APIï¼šhttp://localhost:8080

4. åœæ­¢æœåŠ¡

```bash
cd docker
docker-compose down
```

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒ

#### å‰ææ¡ä»¶

- Python 3.12+
- Node.js 18+
- å®‰è£… Conda æˆ–å…¶ä»–è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·

#### å¯åŠ¨æ­¥éª¤

1. å…‹éš†ä»£ç ä»“åº“

```bash
git clone <ä»“åº“åœ°å€>
cd VanillaRAGPlus
```

2. ä½¿ç”¨å¯åŠ¨è„šæœ¬

```bash
./start.sh
```

## Docker å®¹å™¨è¯´æ˜

æœ¬é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹ Docker å®¹å™¨ï¼š

1. **API å®¹å™¨**ï¼š

   - è¿è¡Œåç«¯ FastAPI æœåŠ¡
   - æš´éœ²ç«¯å£ï¼š8080

2. **Web å®¹å™¨**ï¼š

   - å¼€å‘ç¯å¢ƒï¼šè¿è¡Œ Vue.js å¼€å‘æœåŠ¡å™¨
   - ç”Ÿäº§ç¯å¢ƒï¼šNginx æœåŠ¡é™æ€æ–‡ä»¶
   - æš´éœ²ç«¯å£ï¼š3000 (å¼€å‘) / 80 (ç”Ÿäº§)

3. **PostgreSQL å®¹å™¨**ï¼š

   - å­˜å‚¨ç³»ç»Ÿå…ƒæ•°æ®
   - æš´éœ²ç«¯å£ï¼š5433 (å®¿ä¸»æœº) -> 5432 (å®¹å™¨å†…)

4. **Redis å®¹å™¨**ï¼š

   - ç”¨äºç¼“å­˜
   - æš´éœ²ç«¯å£ï¼š6379

5. **Milvus å®¹å™¨**ï¼š
   - å‘é‡æ•°æ®åº“
   - æš´éœ²ç«¯å£ï¼š19530, 9091

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

å¯¹äºç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼Œæ¨èä»¥ä¸‹é…ç½®ï¼š

1. ä¿®æ”¹ docker-compose.ymlï¼Œå°† web æœåŠ¡çš„æ„å»ºç›®æ ‡æ”¹ä¸º productionï¼š

```yaml
web:
  build:
    context: ..
    dockerfile: docker/web.Dockerfile
    target: production # æ”¹ä¸º production
```

2. æ·»åŠ  HTTPS æ”¯æŒï¼š

   - åœ¨ Nginx é…ç½®ä¸­æ·»åŠ  SSL è¯ä¹¦
   - ä½¿ç”¨åå‘ä»£ç†å¦‚ Traefik æˆ– Nginx Proxy Manager

3. æ·»åŠ ç¯å¢ƒå˜é‡æ–‡ä»¶ .envï¼Œè®¾ç½®æ•æ„Ÿé…ç½®ï¼š
   - æ•°æ®åº“å¯†ç 
   - API å¯†é’¥
   - å…¶ä»–é…ç½®

## å¸¸è§é—®é¢˜

1. **å®¹å™¨æ— æ³•å¯åŠ¨**

   - æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   - æŸ¥çœ‹æ—¥å¿—ï¼š`docker-compose logs -f [æœåŠ¡å]`

2. **å‰ç«¯æ— æ³•è¿æ¥åç«¯**

   - æ£€æŸ¥ VITE_API_URL ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
   - æ£€æŸ¥åç«¯å®¹å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ

3. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ DATABASE_URL ç¯å¢ƒå˜é‡
   - ç¡®è®¤ PostgreSQL å®¹å™¨å¥åº·çŠ¶æ€
